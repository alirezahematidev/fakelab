"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[255],{7827(e,a,s){s.r(a),s.d(a,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"guides/database-mode","title":"Database Mode","description":"Fakelab can persist generated mock data to a local database. This is useful for testing CRUD operations, maintaining state across development sessions, and simulating real database behavior.","source":"@site/docs/guides/database-mode.md","sourceDirName":"guides","slug":"/guides/database-mode","permalink":"/fakelab/docs/guides/database-mode","draft":false,"unlisted":false,"editUrl":"https://github.com/alirezahematidev/fakelab/docs/guides/database-mode.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Runtime API","permalink":"/fakelab/docs/guides/runtime-api"},"next":{"title":"Snapshot","permalink":"/fakelab/docs/guides/snapshot"}}');var t=s(4848),r=s(8453);const i={sidebar_position:3},d="Database Mode",l={},o=[{value:"Overview",id:"overview",level:2},{value:"Enabling Database Mode",id:"enabling-database-mode",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Getting Data",id:"getting-data",level:3},{value:"Inserting Data",id:"inserting-data",level:3},{value:"Database Seeding",id:"database-seeding",level:2},{value:"Seed Options",id:"seed-options",level:3},{value:"Seed Strategies",id:"seed-strategies",level:3},{value:"<code>reset</code> (Default)",id:"reset-default",level:4},{value:"<code>once</code>",id:"once",level:4},{value:"<code>merge</code>",id:"merge",level:4},{value:"Flushing Data",id:"flushing-data",level:2},{value:"Complete Example",id:"complete-example",level:2},{value:"Database Storage",id:"database-storage",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Testing CRUD Operations",id:"testing-crud-operations",level:3},{value:"Maintaining State",id:"maintaining-state",level:3},{value:"Development Workflow",id:"development-workflow",level:3},{value:"Best Practices",id:"best-practices",level:2}];function c(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.header,{children:(0,t.jsx)(a.h1,{id:"database-mode",children:"Database Mode"})}),"\n",(0,t.jsx)(a.p,{children:"Fakelab can persist generated mock data to a local database. This is useful for testing CRUD operations, maintaining state across development sessions, and simulating real database behavior."}),"\n",(0,t.jsx)(a.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(a.p,{children:["Under the hood, Fakelab uses the lightweight ",(0,t.jsx)(a.a,{href:"https://github.com/typicode/lowdb",children:"lowdb"})," library for persistence, ensuring:"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Fast reads and writes"}),"\n",(0,t.jsx)(a.li,{children:"Simple JSON storage"}),"\n",(0,t.jsx)(a.li,{children:"Zero external dependencies"}),"\n"]}),"\n",(0,t.jsx)(a.h2,{id:"enabling-database-mode",children:"Enabling Database Mode"}),"\n",(0,t.jsx)(a.p,{children:"Enable database mode in your configuration:"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'// fakelab.config.ts\r\nimport { defineConfig } from "fakelab";\r\n\r\nexport default defineConfig({\r\n  sourcePath: ["./fixtures"],\r\n  database: { enabled: true },\r\n});\n'})}),"\n",(0,t.jsx)(a.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(a.h3,{id:"getting-data",children:"Getting Data"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\n\r\nconst users = await database.get("User");\r\nconsole.log(users);\n'})}),"\n",(0,t.jsx)(a.h3,{id:"inserting-data",children:"Inserting Data"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\n\r\n// Insert a single User\r\nawait database.post("User");\r\n\r\n// Insert multiple Users\r\nawait database.post("User", 10);\n'})}),"\n",(0,t.jsx)(a.h2,{id:"database-seeding",children:"Database Seeding"}),"\n",(0,t.jsx)(a.p,{children:"Database seeding allows you to initialize your database with mock data."}),"\n",(0,t.jsx)(a.h3,{id:"seed-options",children:"Seed Options"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'type SeedOptions = {\r\n  count?: number;\r\n  strategy?: "reset" | "once" | "merge";\r\n};\n'})}),"\n",(0,t.jsxs)(a.table,{children:[(0,t.jsx)(a.thead,{children:(0,t.jsxs)(a.tr,{children:[(0,t.jsx)(a.th,{children:"Option"}),(0,t.jsx)(a.th,{children:"Type"}),(0,t.jsx)(a.th,{children:"Description"})]})}),(0,t.jsxs)(a.tbody,{children:[(0,t.jsxs)(a.tr,{children:[(0,t.jsx)(a.td,{children:(0,t.jsx)(a.code,{children:"count"})}),(0,t.jsx)(a.td,{children:(0,t.jsx)(a.code,{children:"number"})}),(0,t.jsx)(a.td,{children:"Number of records to generate"})]}),(0,t.jsxs)(a.tr,{children:[(0,t.jsx)(a.td,{children:(0,t.jsx)(a.code,{children:"strategy"})}),(0,t.jsxs)(a.td,{children:[(0,t.jsx)(a.code,{children:"reset"}),", ",(0,t.jsx)(a.code,{children:"once"}),", ",(0,t.jsx)(a.code,{children:"merge"})]}),(0,t.jsxs)(a.td,{children:["Defines how seeding interacts with existing database data. Default is ",(0,t.jsx)(a.code,{children:"reset"})]})]})]})]}),"\n",(0,t.jsx)(a.h3,{id:"seed-strategies",children:"Seed Strategies"}),"\n",(0,t.jsxs)(a.h4,{id:"reset-default",children:[(0,t.jsx)(a.code,{children:"reset"})," (Default)"]}),"\n",(0,t.jsx)(a.p,{children:"Removes all existing data and recreates it from scratch."}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\n\r\nawait database.seed("User", {\r\n  count: 10,\r\n  strategy: "reset",\r\n});\n'})}),"\n",(0,t.jsx)(a.h4,{id:"once",children:(0,t.jsx)(a.code,{children:"once"})}),"\n",(0,t.jsx)(a.p,{children:"Seeds data only if the database is empty. Useful for initial setup."}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\n\r\nawait database.seed("User", {\r\n  count: 10,\r\n  strategy: "once",\r\n});\n'})}),"\n",(0,t.jsx)(a.h4,{id:"merge",children:(0,t.jsx)(a.code,{children:"merge"})}),"\n",(0,t.jsxs)(a.p,{children:["Inserts new records and updates existing ones. The total number of items per table is limited to ",(0,t.jsx)(a.code,{children:"1000"})," records."]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\n\r\nawait database.seed("User", {\r\n  count: 5,\r\n  strategy: "merge",\r\n});\n'})}),"\n",(0,t.jsx)(a.h2,{id:"flushing-data",children:"Flushing Data"}),"\n",(0,t.jsx)(a.p,{children:"Clear all data from a specific table:"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\n\r\nawait database.flush("User");\n'})}),"\n",(0,t.jsx)(a.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'import { database } from "fakelab/browser";\r\nimport type { User } from "./types/user";\r\n\r\n// Seed initial data\r\nawait database.seed("User", {\r\n  count: 10,\r\n  strategy: "reset",\r\n});\r\n\r\n// Get all users\r\nconst users = await database.get<User[]>("User");\r\nconsole.log("All users:", users);\r\n\r\n// Add a new user\r\nawait database.post("User");\r\nconst updatedUsers = await database.get<User[]>("User");\r\nconsole.log("Updated users:", updatedUsers);\r\n\r\n// Clear all users\r\nawait database.flush("User");\r\nconst emptyUsers = await database.get<User[]>("User");\r\nconsole.log("After flush:", emptyUsers); // []\n'})}),"\n",(0,t.jsx)(a.h2,{id:"database-storage",children:"Database Storage"}),"\n",(0,t.jsx)(a.p,{children:"The database is stored as a JSON file in your project directory. The default location is:"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:".fakelab/db\n"})}),"\n",(0,t.jsx)(a.p,{children:"This file is automatically created when database mode is enabled and data is inserted."}),"\n",(0,t.jsx)(a.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsx)(a.h3,{id:"testing-crud-operations",children:"Testing CRUD Operations"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'// Create\r\nawait database.post("User");\r\n\r\n// Read\r\nconst users = await database.get("User");\r\n\r\n// Update (via merge strategy)\r\nawait database.seed("User", { count: 1, strategy: "merge" });\r\n\r\n// Delete (flush)\r\nawait database.flush("User");\n'})}),"\n",(0,t.jsx)(a.h3,{id:"maintaining-state",children:"Maintaining State"}),"\n",(0,t.jsx)(a.p,{children:"Database mode allows you to maintain state across server restarts, making it perfect for:"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Testing stateful applications"}),"\n",(0,t.jsx)(a.li,{children:"Simulating real database behavior"}),"\n",(0,t.jsx)(a.li,{children:"Debugging data flow issues"}),"\n"]}),"\n",(0,t.jsx)(a.h3,{id:"development-workflow",children:"Development Workflow"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-typescript",children:'// On app startup\r\nawait database.seed("User", {\r\n  count: 20,\r\n  strategy: "once", // Only seed if empty\r\n});\r\n\r\n// During development, data persists\r\n// You can modify data and it will remain until flushed\n'})}),"\n",(0,t.jsx)(a.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsxs)(a.strong,{children:["Use ",(0,t.jsx)(a.code,{children:"once"})," strategy for initial seeding"]})," - Prevents overwriting data on every app start"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.strong,{children:"Flush before tests"})," - Ensure clean state for each test run"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.strong,{children:"Limit merge operations"})," - Remember the 1000 record limit per table"]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.strong,{children:"Commit database file to git"})," - For consistent development environments (optional)"]}),"\n"]})]})}function h(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,a,s){s.d(a,{R:()=>i,x:()=>d});var n=s(6540);const t={},r=n.createContext(t);function i(e){const a=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);